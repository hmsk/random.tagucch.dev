---
title: '画像内の文字列を検索できるコマンド、投稿用のマークダウンファイルを楽に生成したい、Fastlyの障害'
date: '2021-06-10'
tags: ['ripgrep-all', 'markdown', 'okimochi', 'fastly']
---

## 画像内の文字を grep で検索できるやつ

今日のタブ記事

[画像ファイルやデータベースの文字列を「grep」のように検索できる「ripgrep-all」](https://gigazine.net/news/20201204-ripgrep-all/)

grep コマンドみたいな感覚で動画ファイルのメタデータや画像ファイル内の文字列を検索できるコマンドらしい。すごいな。

たしかこの記事が出た日にブクマした気がするんだけど、内容はちゃんと覚えてなかった。

macOS でも使えるとのことなので、ちょっと試してみようかなと思う。

しかし、`rga キーワード 検索対象`というコマンドだけで検索対象の画像内の文字が検索できてしまうの、すごすぎる。

前になにかの文字が書いてあるネタ画像を探そうとしたときにとりあえずその文字で Google 検索をしたりするくらいしかできなかったのだけど、こういうやつを使えばそれを実現できるのだろうか……？

ちなみに、逆に文字情報を画像認識してコンピューターが利用できる文字情報にすることを OCR(Optical Character Recognition/Reader、光学的文字認識)というらしい。

## その日書くマークダウンファイルを楽に生成したい

このサイトに新しく投稿する内容を書くとき、以下のような手順でやっている。すべて VS Code で完結している。

- 前日のマークダウンファイルをひとまずコピーして同じディレクトリに置く
- ファイル名をその日の日付に更新する
- メタ情報の部分を更新する
  - メタ情報は`title`、`date`、`tags`の 3 つで構成されている
  - この段階ではひとまず`date`をその日の日付にする
- 前日の内容を全て消す
- 新しい内容を書く
- メタ情報の`title`と`tags`を修正する

こんな感じ。

まっさらから書くよりは、メタ情報の部分は直すだけとかそんな感じなので楽といえば楽だが、なんかあんまりスマートではない。

投稿画面編集画面までリッチなものは作らないにしても、もうちょっと便利にしたい。

そんな気持ちになったので、叩いたら特定のディレクトリに`[その日の日付].md`という、メタ情報の部分が以下のような感じで入っているファイルを作るコマンドを作りたい。

```md
---
title: ''
date: '(その日の日付)'
tags: ['']
---
```

本当は「ほしかったので作りました！」とサラッと言えればかっこいいんだけど、まあそんなスーパーな人ならこんなサイト作ってないし、ひとまずほしいものをほしいと素直に書いてやっていこうと思います。

## fastly の障害について

[fastly の CDN で発生したシステム障害についてまとめてみた](https://piyolog.hatenadiary.jp/entry/2021/06/09/162850)

8 日に fastly の CDN で障害が起きて Twitter で騒ぎになっていた。原因はソフトウェアの潜在的な不具合らしい。

障害検知が発生から 1 分後で、49 分以内にネットワークの 95%が普及したらしい。対応が迅速すぎる。

影響を受けたサービス一覧がこの記事で見れるが、錚々たるサービスがずらずらと並んでいてびっくり。fastly はそれだけ使われているんだなあ。

### fastly についての別記事

[何故 Fastly を使うのか](https://anond.hatelabo.jp/20210609095300)

今回の障害で話題になっていたけど、普段 CDN について考慮することや仕事で話すことがほとんどないので、fastly は名前を知っているくらいだった。

実際なにが良くて選ばれてるんだろうと思っていたらこの記事が流れてきた。

この記事によると、

- キャッシュが消えるのがはやい = 消したいと思ったら即消せる
- 設定の反映がはやい
- Web の設定画面がいい感じ
- いざとなれば設定ファイルをアップロードできる

というところがいいらしい。

マジで CDN 初心者みたいな感じなので感覚だけど、設定や削除の反映がはやくて、かつ設定も細かくできて(特定のキーがついているキャッシュだけ消せるみたいなやつ)、設定画面がユーザーフレンドリーで、さらに高度な設定をしたかったら設定ファイルを書いてアップロードできる、ということっぽい。

あと関係ないけど日本人の有名な方が勤めてる印象がある。Tatsuhiko Miyagawa さんとか。

そういえば、Amazon が fastly を使っていたみたいなツイートが話題になっていたけど、自前で持ってる cloudfront より信頼できるということなんだろうか。
